@using ReservAntes.ViewModels
@model  ReservaViewModel
@{
    ViewBag.Title = "Reservar";
    Layout = "~/Views/Shared/_LayoutCliente.cshtml";
    int indexPlatos = 0;

}

<h2 class="thumbnail">Reservar en @Model.restauranteNombre</h2>



@if (Model.platosElegidosVm==null)
{
    using (Html.BeginForm("Reserva", "Cliente", FormMethod.Post, new { reserva = @Model }))
    {
        @Html.HiddenFor(u => u.RestauranteId)
        @Html.HiddenFor(u => u.FechaHoraReserva)
        @Html.HiddenFor(u => u.CantidadComensales)
        @Html.ValidationSummary(false, "", new { @class = "text-danger" })

        <div class="table-responsive thumbnail">
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <td>Nombre</td>
                        <td>Precio</td>
                        <td>Cantidad</td>
                    </tr>

                <thead />
                <tbody>

                    @foreach (var plato in Model.platos)
                    {
                        <tr>
                            <td>@plato.NombrePlato</td>
                            <td>$@plato.Precio</td>
                            <td>
                                @Html.DropDownListFor(u => u.PlatoCantidad[indexPlatos], new SelectList(plato.cantidadPlatos), "Cantidad", new { @class = "form-control" })
                                <input type="hidden" value="@plato.Id" name="PlatoId[@indexPlatos]" />
                                @Html.HiddenFor(m => plato.Id)
                            </td>
                        </tr>
                        indexPlatos++;
                    }

                </tbody>
            </table>
        </div>
        <br />

        @*@Html.ActionLink("Reservar", "PlatosElegidos", "Cliente", new { @reserva = @Model }, new { @class = "btn btn-default btn-success btn-lg btn-block" })*@
        <button type="submit" class="btn btn-primary">Reservar</button>
    }
}
@if (Model != null && Model.platosElegidosVm != null && Model.platosElegidosVm.Count > 0)

{
    using (Html.BeginForm("ConfirmarReserva", "Cliente", FormMethod.Post, new { reservaFinal = @Model }))
    {
        @Html.HiddenFor(u => u.RestauranteId)
        @Html.HiddenFor(u => u.FechaHoraReserva)
        @Html.HiddenFor(u => u.CantidadComensales)
        @Html.HiddenFor(u=>u.PlatosElegidos)

        <table class="table table-striped table-hover">
            <thead>
                <tr>
                    <th>Plato</th>
                    <th>Cantidad</th>
                    <th>Total</th>
                </tr>
            </thead>
            <tbody>

                @foreach (var item in Model.platosElegidosVm)
                {

                    <tr class="active">
                        <td>
                            @Html.DisplayFor(modelItem => item.nombrePlato)
                        </td>

                        <td>
                            @Html.DisplayFor(modelItem => item.Cantidad)
                        </td>

                        <td>
                            $ @Html.DisplayFor(modelItem => item.subTotal)
                        </td>
                    </tr>
                }

            </tbody>

        </table>

        @*<button type="submit" class="btn btn-primary">Reservar</button>*@
        <p>Cantidad de Comensales: @Html.DisplayFor(model => model.CantidadComensales)</p>

        <p>Horario: @Html.DisplayFor(model => model.FechaHoraReserva.Hour) :00 horas </p>
        <h3>Total: $ @Html.DisplayFor(model => model.Total)  </h3>
        <button type="submit" class="btn btn-default btn-success btn-lg btn-block">Confirmar Reserva</button>

        @*<div>
                @Html.ActionLink("Confirmar Reserva", "ConfirmarReserva", "Cliente", new { @reservaFinal = Model }, new { @class = "btn btn-default btn-success btn-lg btn-block" })
            </div>*@
    }
}

<button onclick="location.href='@Url.Action("Index", "Cliente")';return false;" class="btn btn-danger">Cancelar</button>


@*<a href="<% Response.Write(preference[" response"]["init_point"]); %>">Pagar</a>*@

